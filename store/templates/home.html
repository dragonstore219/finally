{% extends 'base.html' %} {% load static %}
<!-- This line loads the static tag -->
{% block content %}
<!--=============== MAIN ===============-->
<div id="preloader">
  <div class="logo-container">
      <img src="{% static 'img/LL.png' %}" alt="Logo" class="logo">
      <div class="loading-shadow"></div>
  </div>
</div>
<main  class="main ml" id="main">
  <!--==================== HOME ====================-->
  <section class="home" id="home" >
    <div class="video-container">
      <video class="home__video" autoplay muted loop>
        <source
          src="{% static 'video/clothes.mp4' %}"
          type="video/mp4"
          type="video/mp4"
        />
      </video>
      <div class="video-overlay"></div>
    </div>
    <div class="home__img"></div>
    <div class="home__container container grid">
      <div class="home__data">
        <h1 class="home__title">
          Discover Your<br />
          Style with Dragon
        </h1>
        <p class="home__description">
          Welcome to Deragon, where fashion meets elegance. </br> Explore our latest collections and redefine your style.

        </p>
        <a style="    padding: 0.3rem 1.5rem;" href="#featured" class="button button--flex">
          Shop Now <i class="ri-arrow-down-circle-line"></i>
        </a>
      </div>

      <div class="home__social">
        <span class="home__social-follow">Follow Us</span>

        <div class="home__social-links">
          <a
            href="https://www.facebook.com/"
            target="_blank"
            class="home__social-link"
          >
            <i class="ri-facebook-fill"></i>
          </a>
          <a
            href="https://www.facebook.com/"
            target="_blank"
            class="home__social-link"
          >
            <i class="fa-brands fa-tiktok"></i>
          </a>
          <a
            href="https://www.instagram.com/"
            target="_blank"
            class="home__social-link"
          >
            <i class="ri-instagram-line"></i>
          </a>
          <a
            href="https://twitter.com/"
            target="_blank"
            class="home__social-link"
          >
            <i class="ri-youtube-fill"></i>
          </a>
        </div>
      </div>
    </div>
  </section>


<!--==================== NEW ====================-->
<section class="new section" id="new">
  <h2 class="section__title">
      New Cetegories
  </h2>
  <div class="new__container container grid">
    <article class="new__card">
      <img src="{% static 'img/sweatpants.webp' %}" alt="" class="new__img">
      <a href="{% url 'category' 'Sweet-Pants'%}" class="new__link">
          <div class="new__data">
              <h2 class="new__title">
                  Sweet Pants
              </h2>
              <span class="new__subtitle">
                  Summer Collection
              </span>
          </div>
          <i class="ri-arrow-right-line"></i>
      </a>
  </article>
  

  <article class="new__card">
    <img src="{% static 'img/collectmen3.webp' %}" alt="" class="new__img">
    <a href="{% url 'category' 'Shorts'%}" class="new__link">
        <div class="new__data">
            <h2 class="new__title">
                Shorts
            </h2>
            <span class="new__subtitle">
                Summer Collection
            </span>
        </div>
        <i class="ri-arrow-right-line"></i>
    </a>
</article>


<article class="new__card">
  <img src="{% static 'img/te-shirt.webp' %}" alt="" class="new__img">
  <a href="{% url 'category' 'T-shirt'%}" class="new__link">
      <div class="new__data">
          <h2 class="new__title">
              T-shirt
          </h2>
          <span class="new__subtitle">
              Summer Collection
          </span>
      </div>
      <i class="ri-arrow-right-line"></i>
  </a>
</article>

  </div>
</section>

<!--==================== COLLECTION ====================-->
<section class="collection section" id="collection">
  <div class="collection__container container">
      <div class="collection__explore">
          <div class="collection__data-men">
              <h2 class="collection__title">
                  Men <br> Collection
              </h2>
              <a href="{% url 'collection' 'men' %}" class="button__link">
                Explore Clothes <i class="ri-arrow-right-line"></i>
            </a>
          </div>
          <img src=" {% static 'img/collectman1.webp' %}" alt="">
      </div>

      <div class="collection__explore">
          <img src=" {% static 'img/collectwomen2.webp' %}" alt="">
          <div class="collection__data-women">
              <h2 class="collection__title">
                  Women <br> Collection
              </h2>
              <a href="{% url 'collection' 'women' %}" class="button__link">
                Explore Clothes <i class="ri-arrow-right-line"></i>
              </a>
          </div>
      </div>

   
  </div>
</section>


<section class="featured section" id="featured" data-aos="fade-right">
    <h2 class="section__title">Top Picks for Your Active Lifestyle</h2>
    <div class="featured__container container">
      <div class="featured__swiper swiper">
        <div class="swiper-wrapper">
          {% for product in products %}
          <article class="featured__card swiper-slide">
            <!-- Product Image -->
            <img
              src="{{ product.image.url }}"
              alt="{{ product.name }}"
              class="featured__img"
            />

            <!-- Product Title -->
            <h2 class="featured__title">{{ product.name }}</h2>

            <div class="featured__prices">
              {% if product.is_sale %}
              <span class="featured__discount"> EGP {{ product.sale_price }}</span>
              <span class="featured__price"
                ><strike class="strikenum">EGP {{ product.price }}</strike></span
              >
              {% else %}
              <span class="featured__price">EGP {{ product.price }}</span>
              {% endif %}
            </div>

            <a href="{% url 'product' product.id %}" class="button"
              >View Product</a
            >
          </article>
          {% endfor %}
        </div>
      </div>
    </div>
  </section>
  <!-- =============TESTIMONIAL============ -->
  <section class="testimonial section" id="testimonial" data-aos="fade-right">
    <h2 class="section__title">What Our Customers Say</h2>
    <div class="testimonial__container container">
        <div class="testimonial__swiper swiper">
            <div class="swiper-wrapper">
                <!-- Testimonial 1 -->
                <article class="testimonial__card swiper-slide">
                    <img src="{% static 'img/client1.webp' %}" alt="Client 1" class="testimonial__img" />
                    <h2 class="testimonial__title">محمد أحمد</h2>
                    <p class="testimonial__description">
                        "المنتجات بجد ممتازة، والجودة عالية جدًا. الخدمة كانت رائعة والتوصيل وصل في معاده بالظبط. أنصح أي حد جاد باللبس ده، مريح وشكل رائع!"
                    </p>
                    
                    <div class="testimonial__stars">
                        <i class="ri-gemini-fill"></i>
                        <i class="ri-gemini-fill"></i>
                        <i class="ri-gemini-fill"></i>
                        <i class="ri-gemini-fill"></i>
                        <i class="ri-gemini-fill"></i>
                    </div>
                </article>

                <!-- Testimonial 2 -->
                <article class="testimonial__card swiper-slide">
                    <img src="{% static 'img/client2.webp' %}" alt="Client 2" class="testimonial__img" />
                    <h2 class="testimonial__title">عمر سعيد</h2>
                    <p class="testimonial__description">
                        "الاختيارات عندهم متنوعة جدًا، لقيت بالضبط اللي كنت بدور عليه، والأسعار معقولة جدًا مقارنة بالجودة. أكيد هشتري تاني!"
                    </p>
                    
                    <div class="testimonial__stars">
                        <i class="ri-gemini-fill"></i>
                        <i class="ri-gemini-fill"></i>
                        <i class="ri-gemini-fill"></i>
                        <i class="ri-gemini-fill"></i>
                        <i class="ri-gemini-fill"></i>
                    </div>
                </article>

                <!-- Testimonial 3 -->
                <article class="testimonial__card swiper-slide">
                  <img src="{% static 'img/client3.webp' %}" alt="Client 3" class="testimonial__img" />
                  <h2 class="testimonial__title">أحمد محمود</h2>
                  <p class="testimonial__description">
                      "الجودة ممتازة والتصميم مريح جدًا! أنا مبسوط جدًا بالتيشيرت اللي اشتريته من هنا، وحتى خليت أصحابي يجوا يشتروا منه."
                  </p>
              
                  <div class="testimonial__stars">
                      <i class="ri-gemini-fill"></i>
                      <i class="ri-gemini-fill"></i>
                      <i class="ri-gemini-fill"></i>
                      <i class="ri-gemini-fill"></i>
                      <i class="ri-gemini-fill"></i>
                  </div>
              </article>

                <!-- Testimonial 4 -->
                <article class="testimonial__card swiper-slide">
                    <img src="{% static 'img/client1.webp' %}" alt="Client 4" class="testimonial__img" />
                    <h2 class="testimonial__title">أحمد فؤاد</h2>
                        <p class="testimonial__description">
                            "الخدمة والجودة كانت فوق توقعاتي. المتجر ده لازم تزوره لأي حد عاوز ملابس شيك وعمرها طويل."
                        </p>

                    <div class="testimonial__stars">
                        <i class="ri-gemini-fill"></i>
                        <i class="ri-gemini-fill"></i>
                        <i class="ri-gemini-fill"></i>
                        <i class="ri-gemini-fill"></i>
                        <i class="ri-gemini-fill"></i>
                    </div>
                </article>
            </div>
        </div>
    </div>
</section>

</main>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const likeButtons = document.querySelectorAll('.like-btn');

    likeButtons.forEach(button => {
        button.addEventListener('click', function () {
            const imageId = button.getAttribute('data-image-id');
            const liked = button.getAttribute('data-liked') === 'true';

            fetch(`/toggle-like/${imageId}/`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRFToken': getCookie('csrftoken'),
                },
                body: JSON.stringify({ liked: !liked }),
            })
            .then(response => {
                if (!response.ok) throw new Error('Network response was not ok');
                return response.json();
            })
            .then(data => {
                if (data.liked !== undefined) {
                    // تحديث حالة الإعجاب ولون الزر
                    button.setAttribute('data-liked', data.liked ? 'true' : 'false');
                    button.style.color = data.liked ? 'red' : 'gray';
                    
                    // تحديث عدد الإعجابات
                    button.nextElementSibling.textContent = data.likes_count;
                } else if (data.error) {
                    console.error(data.error);
                }
            })
            .catch(error => {
                console.error('Error:', error);
            });
        });
    });

    function getCookie(name) {
        let cookieValue = null;
        if (document.cookie && document.cookie !== '') {
            const cookies = document.cookie.split(';');
            for (let i = 0; i < cookies.length; i++) {
                const cookie = cookies[i].trim();
                if (cookie.substring(0, name.length + 1) === (name + '=')) {
                    cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                    break;
                }
            }
        }
        return cookieValue;
    }
});

</script>
<script>
  window.addEventListener("load", function() {
      var loader = document.getElementById("preloader");
      loader.style.opacity = "0"; // إضافة تأثير للاختفاء بشكل تدريجي
      setTimeout(function() {
          loader.style.display = "none"; // بعد أن يختفي تدريجيًا، نقوم بإخفائه
      }, 1000); // انتظر 1 ثانية (لتأثير الـ opacity)
  });
</script>
{% endblock %}